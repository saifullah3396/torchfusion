2024-03-20 23:09:03,160 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:09:03,165 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:09:03,165 torchfusion INFO: Global seed set to 42
2024-03-20 23:09:03,173 torchfusion INFO: Setting up datamodule...
2024-03-20 23:09:03,173 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:09:03,800 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: Please provide either num_classes, names or names_file.
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 223, in _load_fusion_dataset
    builder = self._get_builder()
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 298, in _get_builder
    return DatasetFactory.create_builder(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 54, in create_builder
    return load_dataset_builder(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2265, in load_dataset_builder
    builder_instance: DatasetBuilder = builder_cls(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 22, in __init__
    super().__init__(*args, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 382, in __init__
    info.update(self._info())
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_image_dataset.py", line 33, in _info
    features=self._dataset_features(),
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/55142d92be166c0a13f100a7be83602d7436991e16d72e6d6ce5cb9f42720e39/sroie.py", line 123, in _dataset_features
    dataset_features = super()._dataset_features()
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_image_dataset.py", line 45, in _dataset_features
    DataKeys.LABEL: datasets.features.ClassLabel(names=self.config.labels),
  File "<string>", line 5, in __init__
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 986, in __post_init__
    raise ValueError("Please provide either num_classes, names or names_file.")
ValueError: Please provide either num_classes, names or names_file.
2024-03-20 23:09:40,206 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:09:40,211 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:09:40,211 torchfusion INFO: Global seed set to 42
2024-03-20 23:09:40,219 torchfusion INFO: Setting up datamodule...
2024-03-20 23:09:40,219 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:09:40,817 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: Subclasses must implement _dataset_features()
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 223, in _load_fusion_dataset
    builder = self._get_builder()
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 298, in _get_builder
    return DatasetFactory.create_builder(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 54, in create_builder
    return load_dataset_builder(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2265, in load_dataset_builder
    builder_instance: DatasetBuilder = builder_cls(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 22, in __init__
    super().__init__(*args, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 382, in __init__
    info.update(self._info())
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 37, in _info
    features=self._dataset_features(),
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/21148f34c5dba535f20edd85bced90e2569c16035e902cf9afe2a711f524de39/sroie.py", line 125, in _dataset_features
    dataset_features = super()._dataset_features()
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 32, in _dataset_features
    raise NotImplementedError("Subclasses must implement _dataset_features()")
NotImplementedError: Subclasses must implement _dataset_features()
2024-03-20 23:10:02,549 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:10:02,554 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:10:02,554 torchfusion INFO: Global seed set to 42
2024-03-20 23:10:02,562 torchfusion INFO: Setting up datamodule...
2024-03-20 23:10:02,562 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:10:03,134 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: Subclasses must implement _dataset_features()
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 223, in _load_fusion_dataset
    builder = self._get_builder()
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 298, in _get_builder
    return DatasetFactory.create_builder(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 54, in create_builder
    return load_dataset_builder(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2265, in load_dataset_builder
    builder_instance: DatasetBuilder = builder_cls(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 22, in __init__
    super().__init__(*args, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 382, in __init__
    info.update(self._info())
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 37, in _info
    features=self._dataset_features(),
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/1f1fe6bde4d3885b546a320f11e8763732a6332e062f6f95e23dd60450699766/sroie.py", line 126, in _dataset_features
    dataset_features = super()._dataset_features()
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 32, in _dataset_features
    raise NotImplementedError("Subclasses must implement _dataset_features()")
NotImplementedError: Subclasses must implement _dataset_features()
2024-03-20 23:11:10,250 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:11:10,256 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:11:10,256 torchfusion INFO: Global seed set to 42
2024-03-20 23:11:10,263 torchfusion INFO: Setting up datamodule...
2024-03-20 23:11:10,263 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:11:11,273 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/DocBank//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:11:11,610 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-20 23:11:11,611 torchfusion.core.data.datasets.msgpack.builder WARNING: Using num_proc=4 for a single shard instead of multiprocessing with multiple hards for train split.
2024-03-20 23:11:11,641 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
TypeError: SROIE._generate_examples_impl() got an unexpected keyword argument 'data_dir'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-20 23:12:13,888 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:12:13,894 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:12:13,894 torchfusion INFO: Global seed set to 42
2024-03-20 23:12:13,902 torchfusion INFO: Setting up datamodule...
2024-03-20 23:12:13,902 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:12:14,727 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/DocBank//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:12:15,050 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-20 23:12:15,051 torchfusion.core.data.datasets.msgpack.builder WARNING: Using num_proc=4 for a single shard instead of multiprocessing with multiple hards for train split.
2024-03-20 23:12:21,729 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/b2adef9aeffb8a08962a46f9d2559742ba3d32570c77d821aa1290fa8f38ea38/sroie.py", line 222, in _generate_examples_impl
    return self._preprocess_dataset(data)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/b2adef9aeffb8a08962a46f9d2559742ba3d32570c77d821aa1290fa8f38ea38/sroie.py", line 162, in _preprocess_dataset
    tokenized_data = self.self.config.tokenizer(g.to_dict("list"))
AttributeError: 'SROIE' object has no attribute 'self'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-20 23:12:38,110 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:12:38,115 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:12:38,115 torchfusion INFO: Global seed set to 42
2024-03-20 23:12:38,123 torchfusion INFO: Setting up datamodule...
2024-03-20 23:12:38,123 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:12:38,881 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/DocBank//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:12:39,213 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-20 23:12:39,214 torchfusion.core.data.datasets.msgpack.builder WARNING: Using num_proc=4 for a single shard instead of multiprocessing with multiple hards for train split.
[2024-03-20 23:12:43,846][root][INFO] - Received ctrl-c interrupt. Stopping training...
2024-03-20 23:12:47,448 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:12:47,453 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:12:47,453 torchfusion INFO: Global seed set to 42
2024-03-20 23:12:47,463 torchfusion INFO: Setting up datamodule...
2024-03-20 23:12:47,464 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:12:48,177 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/DocBank//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:12:48,502 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-20 23:12:48,503 torchfusion.core.data.datasets.msgpack.builder WARNING: Using num_proc=4 for a single shard instead of multiprocessing with multiple hards for train split.
2024-03-20 23:12:52,397 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0c9ba70af838f1649703ff3e70507c6b2bd4e4c17bb4b12b5415a5bd4f95ce90/sroie.py", line 218, in _generate_examples_impl
    return self._preprocess_dataset(data)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0c9ba70af838f1649703ff3e70507c6b2bd4e4c17bb4b12b5415a5bd4f95ce90/sroie.py", line 158, in _preprocess_dataset
    tokenized_data = self.config.tokenizer(g.to_dict("list"))
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/text_utils/tokenizers/hf_tokenizer.py", line 122, in __call__
    samples = data_padder(samples)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/text_utils/tokenizers/hf_tokenizer.py", line 176, in __call__
    for idx, sample in enumerate(samples):
RuntimeError: dictionary changed size during iteration

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-20 23:13:20,138 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:13:20,144 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:13:20,144 torchfusion INFO: Global seed set to 42
2024-03-20 23:13:20,151 torchfusion INFO: Setting up datamodule...
2024-03-20 23:13:20,152 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:13:20,830 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/DocBank//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:13:21,172 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-20 23:13:21,173 torchfusion.core.data.datasets.msgpack.builder WARNING: Using num_proc=4 for a single shard instead of multiprocessing with multiple hards for train split.
2024-03-20 23:13:24,696 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0c9ba70af838f1649703ff3e70507c6b2bd4e4c17bb4b12b5415a5bd4f95ce90/sroie.py", line 218, in _generate_examples_impl
    return self._preprocess_dataset(data)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0c9ba70af838f1649703ff3e70507c6b2bd4e4c17bb4b12b5415a5bd4f95ce90/sroie.py", line 158, in _preprocess_dataset
    tokenized_data = self.config.tokenizer(g.to_dict("list"))
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/text_utils/tokenizers/hf_tokenizer.py", line 122, in __call__
    samples = data_padder(samples)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/text_utils/tokenizers/hf_tokenizer.py", line 176, in __call__
    for idx, sample in enumerate(samples):
RuntimeError: dictionary changed size during iteration

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-20 23:14:26,235 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:14:26,241 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:14:26,241 torchfusion INFO: Global seed set to 42
2024-03-20 23:14:26,248 torchfusion INFO: Setting up datamodule...
2024-03-20 23:14:26,249 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:14:26,937 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/DocBank//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:14:27,257 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-20 23:14:31,237 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0c9ba70af838f1649703ff3e70507c6b2bd4e4c17bb4b12b5415a5bd4f95ce90/sroie.py", line 218, in _generate_examples_impl
    return self._preprocess_dataset(data)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0c9ba70af838f1649703ff3e70507c6b2bd4e4c17bb4b12b5415a5bd4f95ce90/sroie.py", line 158, in _preprocess_dataset
    tokenized_data = self.config.tokenizer(g.to_dict("list"))
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/text_utils/tokenizers/hf_tokenizer.py", line 122, in __call__
    samples = data_padder(samples)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/text_utils/tokenizers/hf_tokenizer.py", line 176, in __call__
    for idx, sample in enumerate(samples):
RuntimeError: dictionary changed size during iteration

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-20 23:14:43,041 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:14:43,047 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:14:43,047 torchfusion INFO: Global seed set to 42
2024-03-20 23:14:43,055 torchfusion INFO: Setting up datamodule...
2024-03-20 23:14:43,056 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:14:43,747 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/DocBank//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:14:44,059 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-20 23:14:48,891 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0c9ba70af838f1649703ff3e70507c6b2bd4e4c17bb4b12b5415a5bd4f95ce90/sroie.py", line 218, in _generate_examples_impl
    return self._preprocess_dataset(data)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0c9ba70af838f1649703ff3e70507c6b2bd4e4c17bb4b12b5415a5bd4f95ce90/sroie.py", line 158, in _preprocess_dataset
    tokenized_data = self.config.tokenizer(g.to_dict("list"))
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/text_utils/tokenizers/hf_tokenizer.py", line 122, in __call__
    samples = data_padder(samples)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/text_utils/tokenizers/hf_tokenizer.py", line 177, in __call__
    for idx, sample in enumerate(samples):
RuntimeError: dictionary changed size during iteration

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-20 23:15:19,141 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:15:19,148 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:15:19,148 torchfusion INFO: Global seed set to 42
2024-03-20 23:15:19,155 torchfusion INFO: Setting up datamodule...
2024-03-20 23:15:19,156 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:15:19,899 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/DocBank//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:15:20,938 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
[2024-03-20 23:17:39,039][root][INFO] - Received ctrl-c interrupt. Stopping training...
2024-03-20 23:18:02,389 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:18:02,412 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:18:02,412 torchfusion INFO: Global seed set to 42
2024-03-20 23:18:02,494 torchfusion INFO: Setting up datamodule...
2024-03-20 23:18:02,494 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:18:03,988 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/DocBank//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:18:04,344 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-20 23:18:08,637 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0c9ba70af838f1649703ff3e70507c6b2bd4e4c17bb4b12b5415a5bd4f95ce90/sroie.py", line 218, in _generate_examples_impl
    return self._preprocess_dataset(data)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0c9ba70af838f1649703ff3e70507c6b2bd4e4c17bb4b12b5415a5bd4f95ce90/sroie.py", line 158, in _preprocess_dataset
    tokenized_data = self.config.tokenizer(g.to_dict("list"))
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/text_utils/tokenizers/hf_tokenizer.py", line 120, in __call__
    samples = self._process_samples(samples)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/text_utils/tokenizers/hf_tokenizer.py", line 99, in _process_samples
    print(tokenized_data["input_ids"].shape)
AttributeError: 'list' object has no attribute 'shape'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-20 23:18:26,830 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:18:26,836 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:18:26,836 torchfusion INFO: Global seed set to 42
2024-03-20 23:18:26,844 torchfusion INFO: Setting up datamodule...
2024-03-20 23:18:26,844 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:18:27,538 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/DocBank//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:18:27,869 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
[2024-03-20 23:19:39,692][root][INFO] - Received ctrl-c interrupt. Stopping training...
2024-03-20 23:19:43,413 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:19:43,420 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:19:43,420 torchfusion INFO: Global seed set to 42
2024-03-20 23:19:43,427 torchfusion INFO: Setting up datamodule...
2024-03-20 23:19:43,427 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:19:44,114 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/DocBank//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:19:44,431 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
[2024-03-20 23:20:03,974][root][INFO] - Received ctrl-c interrupt. Stopping training...
2024-03-20 23:20:07,999 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:20:08,005 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:20:08,005 torchfusion INFO: Global seed set to 42
2024-03-20 23:20:08,012 torchfusion INFO: Setting up datamodule...
2024-03-20 23:20:08,013 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:20:08,985 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/DocBank//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:20:09,788 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-20 23:20:13,659 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0c9ba70af838f1649703ff3e70507c6b2bd4e4c17bb4b12b5415a5bd4f95ce90/sroie.py", line 218, in _generate_examples_impl
    return self._preprocess_dataset(data)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0c9ba70af838f1649703ff3e70507c6b2bd4e4c17bb4b12b5415a5bd4f95ce90/sroie.py", line 158, in _preprocess_dataset
    tokenized_data = self.config.tokenizer(g.to_dict("list"))
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/text_utils/tokenizers/hf_tokenizer.py", line 125, in __call__
    samples = data_padder(samples)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/text_utils/tokenizers/hf_tokenizer.py", line 181, in __call__
    samples[idx] = self._pad_sample(sample)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/text_utils/tokenizers/hf_tokenizer.py", line 171, in _pad_sample
    [sample[k]],
TypeError: string indices must be integers

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-20 23:20:55,057 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:20:55,063 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:20:55,063 torchfusion INFO: Global seed set to 42
2024-03-20 23:20:55,070 torchfusion INFO: Setting up datamodule...
2024-03-20 23:20:55,070 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:20:55,733 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/DocBank//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:20:56,093 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
[2024-03-20 23:21:06,273][root][INFO] - Received ctrl-c interrupt. Stopping training...
2024-03-20 23:21:09,780 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:21:09,785 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:21:09,785 torchfusion INFO: Global seed set to 42
2024-03-20 23:21:09,793 torchfusion INFO: Setting up datamodule...
2024-03-20 23:21:09,794 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:21:10,458 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/DocBank//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:21:10,788 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
[2024-03-20 23:21:23,234][root][INFO] - Received ctrl-c interrupt. Stopping training...
2024-03-20 23:27:44,294 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:27:44,300 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:27:44,300 torchfusion INFO: Global seed set to 42
2024-03-20 23:27:44,307 torchfusion INFO: Setting up datamodule...
2024-03-20 23:27:44,307 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:27:44,995 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/DocBank//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:27:45,313 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-20 23:27:49,099 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0c24763efd6db49d3b23f2fc1b5d6748049ae54108a3ea3905b2bf2e66f4637a/sroie.py", line 207, in _generate_examples_impl
    return self._preprocess_dataset(data)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0c24763efd6db49d3b23f2fc1b5d6748049ae54108a3ea3905b2bf2e66f4637a/sroie.py", line 158, in _preprocess_dataset
    tokenized_data = self.config.tokenizer(g.to_dict("list"))
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/text_utils/tokenizers/hf_tokenizer.py", line 139, in __call__
    samples = data_padder(samples)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/text_utils/tokenizers/hf_tokenizer.py", line 194, in __call__
    samples[idx] = self._pad_sample(sample)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/text_utils/tokenizers/hf_tokenizer.py", line 185, in _pad_sample
    [sample[k]],
TypeError: string indices must be integers

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-20 23:38:22,712 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:38:22,734 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:38:22,734 torchfusion INFO: Global seed set to 42
2024-03-20 23:38:22,823 torchfusion INFO: Setting up datamodule...
2024-03-20 23:38:22,823 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:38:23,203 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: non-default argument 'keys_to_add_on_overflow' follows default argument
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 331, in _load_dataset
    dataset_class = dataset_class()
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/utilities/module_import.py", line 23, in <lambda>
    importlib.import_module(name + "." + module_name), cls_name
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/data/datasets/ner/sroie.py", line 46, in <module>
    from torchfusion.core.data.text_utils.tokenizers.hf_tokenizer import DataPadder
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/text_utils/tokenizers/hf_tokenizer.py", line 23, in <module>
    class HuggingfaceTokenizer(TorchFusionTokenizer):
  File "/usr/lib/python3.10/dataclasses.py", line 1184, in dataclass
    return wrap(cls)
  File "/usr/lib/python3.10/dataclasses.py", line 1175, in wrap
    return _process_class(cls, init, repr, eq, order, unsafe_hash,
  File "/usr/lib/python3.10/dataclasses.py", line 1024, in _process_class
    _init_fn(all_init_fields,
  File "/usr/lib/python3.10/dataclasses.py", line 544, in _init_fn
    raise TypeError(f'non-default argument {f.name!r} '
TypeError: non-default argument 'keys_to_add_on_overflow' follows default argument
2024-03-20 23:39:06,581 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:39:06,586 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:39:06,586 torchfusion INFO: Global seed set to 42
2024-03-20 23:39:06,594 torchfusion INFO: Setting up datamodule...
2024-03-20 23:39:06,594 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:39:07,584 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/DocBank//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:39:07,927 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-20 23:39:12,110 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/eb9e73aee671554081a83448cd2af385037088ddab3f3b792452995dbe6a620e/sroie.py", line 205, in _generate_examples_impl
    return self._preprocess_dataset(data)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/eb9e73aee671554081a83448cd2af385037088ddab3f3b792452995dbe6a620e/sroie.py", line 160, in _preprocess_dataset
    batch_tokenized_data = {
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/eb9e73aee671554081a83448cd2af385037088ddab3f3b792452995dbe6a620e/sroie.py", line 161, in <dictcomp>
    k: [dic[k] for dic in batch_tokenized_data] for k in batch_tokenized_data[0]
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/eb9e73aee671554081a83448cd2af385037088ddab3f3b792452995dbe6a620e/sroie.py", line 161, in <listcomp>
    k: [dic[k] for dic in batch_tokenized_data] for k in batch_tokenized_data[0]
TypeError: list indices must be integers or slices, not dict

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-20 23:39:37,719 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:39:37,725 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:39:37,725 torchfusion INFO: Global seed set to 42
2024-03-20 23:39:37,733 torchfusion INFO: Setting up datamodule...
2024-03-20 23:39:37,734 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:39:38,402 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/DocBank//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:39:38,722 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-20 23:40:10,794 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:40:10,800 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:40:10,800 torchfusion INFO: Global seed set to 42
2024-03-20 23:40:10,807 torchfusion INFO: Setting up datamodule...
2024-03-20 23:40:10,808 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:40:11,514 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/DocBank//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:40:11,854 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
[2024-03-20 23:41:04,933][root][INFO] - Received ctrl-c interrupt. Stopping training...
2024-03-20 23:41:15,103 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:41:15,109 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:41:15,109 torchfusion INFO: Global seed set to 42
2024-03-20 23:41:15,116 torchfusion INFO: Setting up datamodule...
2024-03-20 23:41:15,117 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:41:15,801 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/DocBank//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:41:16,117 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
[2024-03-20 23:41:26,088][root][INFO] - Received ctrl-c interrupt. Stopping training...
2024-03-20 23:43:50,877 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:43:50,882 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:43:50,882 torchfusion INFO: Global seed set to 42
2024-03-20 23:43:50,890 torchfusion INFO: Setting up datamodule...
2024-03-20 23:43:50,891 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:43:51,596 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:43:51,939 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-20 23:43:51,944 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/4f1a5a77b34c4bd8a592644e386d7429f216f35debf83a9e8806b70705e692ec/sroie.py", line 176, in _generate_examples_impl
    cache_dir = self.config.data_dir / "huggingface"
TypeError: unsupported operand type(s) for /: 'str' and 'str'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-20 23:44:05,996 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:44:06,002 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:44:06,002 torchfusion INFO: Global seed set to 42
2024-03-20 23:44:06,010 torchfusion INFO: Setting up datamodule...
2024-03-20 23:44:06,010 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:44:06,698 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:44:07,038 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
[2024-03-20 23:44:32,568][root][INFO] - Received ctrl-c interrupt. Stopping training...
2024-03-20 23:46:05,312 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:46:05,366 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:46:05,366 torchfusion INFO: Global seed set to 42
2024-03-20 23:46:05,455 torchfusion INFO: Setting up datamodule...
2024-03-20 23:46:05,456 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:46:07,069 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:46:07,393 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-20 23:46:07,425 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/fe390399efb9fbc4b41c263dafe25749069f0c10ef11a188290255bec6f2b895/sroie.py", line 173, in _generate_examples_impl
    cache_dir = self.config.data_dir / "huggingface"
TypeError: unsupported operand type(s) for /: 'str' and 'str'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-20 23:46:23,203 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:46:23,210 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:46:23,210 torchfusion INFO: Global seed set to 42
2024-03-20 23:46:23,219 torchfusion INFO: Setting up datamodule...
2024-03-20 23:46:23,220 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:46:24,081 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:46:24,405 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-20 23:46:28,502 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/3f6c21b68aac8c0c36a8f497334a6e94b47e6b42dd029472338f35bcea28f349/sroie.py", line 191, in _generate_examples_impl
    sample[DataKeys.IMAGE] = PIL.Image.open(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/PIL/Image.py", line 3236, in open
    fp = builtins.open(filename, "rb")
FileNotFoundError: [Errno 2] No such file or directory: '/storage/hf-datasets-cache/all/datasets/89901751940830-config-parquet-and-info-darentang-sroie-aacc85f6/downloads/extracted/152a7c8b8e335ea11ab20a6c13040fb29c89ac2aee4c5c09dd36ad4a6fc28fe4/sroie/train/images/X00016469612.jpg'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-20 23:47:20,929 torchfusion INFO: Starting torchfusion training script
2024-03-20 23:47:20,935 torchfusion INFO: Running task: prepare_dataset
2024-03-20 23:47:20,935 torchfusion INFO: Global seed set to 42
2024-03-20 23:47:20,942 torchfusion INFO: Setting up datamodule...
2024-03-20 23:47:20,943 torchfusion INFO: Loading data for stage == train|test|val
2024-03-20 23:47:21,632 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-20 23:47:21,957 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-20 23:47:25,853 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/071f94e8e8f6e4ffd154e14ebc798115f7182a19033cc686a8a82b9094d92f17/sroie.py", line 192, in _generate_examples_impl
    sample[DataKeys.IMAGE] = PIL.Image.open(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/PIL/Image.py", line 3236, in open
    fp = builtins.open(filename, "rb")
FileNotFoundError: [Errno 2] No such file or directory: '/storage/hf-datasets-cache/all/datasets/89901751940830-config-parquet-and-info-darentang-sroie-aacc85f6/downloads/extracted/152a7c8b8e335ea11ab20a6c13040fb29c89ac2aee4c5c09dd36ad4a6fc28fe4/sroie/train/images/X00016469612.jpg'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:01:11,267 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:01:11,273 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:01:11,273 torchfusion INFO: Global seed set to 42
2024-03-21 00:01:11,281 torchfusion INFO: Setting up datamodule...
2024-03-21 00:01:11,281 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:01:11,332 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: name '_get_drive_url' is not defined
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 331, in _load_dataset
    dataset_class = dataset_class()
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/utilities/module_import.py", line 23, in <lambda>
    importlib.import_module(name + "." + module_name), cls_name
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/data/datasets/ner/sroie.py", line 61, in <module>
    _get_drive_url(
NameError: name '_get_drive_url' is not defined
2024-03-21 00:02:03,032 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:02:03,037 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:02:03,037 torchfusion INFO: Global seed set to 42
2024-03-21 00:02:03,045 torchfusion INFO: Setting up datamodule...
2024-03-21 00:02:03,045 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:02:05,853 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:02:06,186 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:02:06,187 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: 'tuple' object has no attribute 'split'
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1078, in _download_and_prepare
    split_generators = self._split_generators(dl_manager, **split_generators_kwargs)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/d8b3fc16d0a038e5937f9403a31ac204e9ef7b6edf7bedfa8a6aa3eeb739931c/sroie.py", line 156, in _split_generators
    downloaded_file = dl_manager.download_and_extract(get_drive_url(_URL))
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/d8b3fc16d0a038e5937f9403a31ac204e9ef7b6edf7bedfa8a6aa3eeb739931c/sroie.py", line 80, in get_drive_url
    split_url = url.split("/")
AttributeError: 'tuple' object has no attribute 'split'
2024-03-21 00:02:10,871 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:02:10,876 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:02:10,877 torchfusion INFO: Global seed set to 42
2024-03-21 00:02:10,885 torchfusion INFO: Setting up datamodule...
2024-03-21 00:02:10,885 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:02:11,582 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:02:12,409 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:02:12,410 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: 'tuple' object has no attribute 'split'
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1078, in _download_and_prepare
    split_generators = self._split_generators(dl_manager, **split_generators_kwargs)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/d8b3fc16d0a038e5937f9403a31ac204e9ef7b6edf7bedfa8a6aa3eeb739931c/sroie.py", line 156, in _split_generators
    downloaded_file = dl_manager.download_and_extract(get_drive_url(_URL))
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/d8b3fc16d0a038e5937f9403a31ac204e9ef7b6edf7bedfa8a6aa3eeb739931c/sroie.py", line 80, in get_drive_url
    split_url = url.split("/")
AttributeError: 'tuple' object has no attribute 'split'
2024-03-21 00:02:34,090 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:02:34,095 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:02:34,095 torchfusion INFO: Global seed set to 42
2024-03-21 00:02:34,103 torchfusion INFO: Setting up datamodule...
2024-03-21 00:02:34,104 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:02:34,781 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:02:35,619 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:02:36,376 torchfusion.core.data.datasets.download_manager INFO: https://drive.google.com/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD&confirm=t not found in cache or force_download set to True, downloading to /home/ataraxia/Datasets/documents/sroie/huggingface/downloads/tmp069u7v_1
2024-03-21 00:02:37,136 torchfusion.core.data.datasets.download_manager INFO: storing https://drive.google.com/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD&confirm=t in cache at /home/ataraxia/Datasets/documents/sroie/huggingface/downloads/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD
2024-03-21 00:02:37,137 torchfusion.core.data.datasets.download_manager INFO: creating metadata file for /home/ataraxia/Datasets/documents/sroie/huggingface/downloads/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD
2024-03-21 00:02:37,141 torchfusion INFO: Generating examples from = /sroie/train
2024-03-21 00:02:37,142 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/4d8a5ed2969bb17f5c94f0f59fdac430c40636ceac1a150ae5d82c009da3a9cd/sroie.py", line 187, in _generate_examples
    for guid, fname in enumerate(sorted(os.listdir(img_dir))):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
FileNotFoundError: [Errno 2] No such file or directory: '/sroie/train/images'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:02:54,382 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:02:54,388 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:02:54,388 torchfusion INFO: Global seed set to 42
2024-03-21 00:02:54,395 torchfusion INFO: Setting up datamodule...
2024-03-21 00:02:54,395 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:02:55,089 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:02:55,417 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:02:55,422 torchfusion INFO: Generating examples from = /sroie/train
2024-03-21 00:02:55,423 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/7441a7bca5883ea824090da513d1dcd34b09e720ce75a02ce7ba1d7cc4199477/sroie.py", line 187, in _generate_examples
    for guid, fname in enumerate(sorted(os.listdir(img_dir))):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
FileNotFoundError: [Errno 2] No such file or directory: '/sroie/train/images'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:03:17,148 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:03:17,154 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:03:17,154 torchfusion INFO: Global seed set to 42
2024-03-21 00:03:17,162 torchfusion INFO: Setting up datamodule...
2024-03-21 00:03:17,163 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:03:17,869 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:03:18,211 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:03:18,216 torchfusion INFO: Generating examples from = /sroie/train
2024-03-21 00:03:18,218 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/b9d07d69f8e05f18daa14a6366ae31ed444f7dbe67be4c9c1246f76a647ee608/sroie.py", line 188, in _generate_examples
    for guid, fname in enumerate(sorted(os.listdir(img_dir))):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
FileNotFoundError: [Errno 2] No such file or directory: '/sroie/train/images'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:03:43,703 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:03:43,708 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:03:43,708 torchfusion INFO: Global seed set to 42
2024-03-21 00:03:43,716 torchfusion INFO: Setting up datamodule...
2024-03-21 00:03:43,716 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:03:44,407 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:03:44,729 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:03:44,734 torchfusion INFO: Generating examples from = /sroie/train
2024-03-21 00:03:44,736 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/f6b8ddcdce6223d0c837b971f455f8a87ff1c93ac153b2ec2eea18d1192e8e6d/sroie.py", line 188, in _generate_examples
    for guid, fname in enumerate(sorted(os.listdir(img_dir))):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
FileNotFoundError: [Errno 2] No such file or directory: '/sroie/train/images'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:04:03,125 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:04:03,131 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:04:03,131 torchfusion INFO: Global seed set to 42
2024-03-21 00:04:03,139 torchfusion INFO: Setting up datamodule...
2024-03-21 00:04:03,139 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:04:03,856 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:04:04,180 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:04:04,185 torchfusion INFO: Generating examples from = /sroie/train
2024-03-21 00:04:04,187 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/e54c369914f6ab7ee65b766d932f392be59d325a5c3f573371d1d637f8fda8a3/sroie.py", line 193, in _generate_examples
    for guid, fname in enumerate(sorted(os.listdir(img_dir))):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
FileNotFoundError: [Errno 2] No such file or directory: '/sroie/train/images'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:05:43,389 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:05:43,396 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:05:43,396 torchfusion INFO: Global seed set to 42
2024-03-21 00:05:43,404 torchfusion INFO: Setting up datamodule...
2024-03-21 00:05:43,405 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:05:44,147 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:05:44,487 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:05:44,490 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: name 'dest' is not defined
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1078, in _download_and_prepare
    split_generators = self._split_generators(dl_manager, **split_generators_kwargs)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/ae69f2fbfb98703d8d502e8211cf1b8f1cae6b34b42afd7a2777e5940119d904/sroie.py", line 160, in _split_generators
    name=datasets.Split.TRAIN, gen_kwargs={"filepath": dest / "train"}
NameError: name 'dest' is not defined
2024-03-21 00:05:56,414 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:05:56,420 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:05:56,420 torchfusion INFO: Global seed set to 42
2024-03-21 00:05:56,428 torchfusion INFO: Setting up datamodule...
2024-03-21 00:05:56,428 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:05:57,144 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:05:57,478 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:05:57,480 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: unsupported operand type(s) for /: 'str' and 'str'
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1078, in _download_and_prepare
    split_generators = self._split_generators(dl_manager, **split_generators_kwargs)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/ebaf58fcd55df3f74d9bc1f28f1110c203fcf01afd2b8248fdeaceab651511ee/sroie.py", line 161, in _split_generators
    gen_kwargs={"filepath": downloaded_file / "train"},
TypeError: unsupported operand type(s) for /: 'str' and 'str'
2024-03-21 00:06:10,135 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:06:10,141 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:06:10,141 torchfusion INFO: Global seed set to 42
2024-03-21 00:06:10,149 torchfusion INFO: Setting up datamodule...
2024-03-21 00:06:10,150 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:06:11,001 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:06:11,827 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:06:11,833 torchfusion INFO: Generating examples from = /home/ataraxia/Datasets/documents/sroie/huggingface/downloads/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD/train
2024-03-21 00:06:11,834 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/29fcf7049e1040209d43149c677efc30a138124a251c59653d14a8cafafcda7b/sroie.py", line 187, in _generate_examples
    for guid, fname in enumerate(sorted(os.listdir(img_dir))):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD/train/images'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:06:18,845 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:06:18,851 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:06:18,851 torchfusion INFO: Global seed set to 42
2024-03-21 00:06:18,859 torchfusion INFO: Setting up datamodule...
2024-03-21 00:06:18,859 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:06:19,535 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:06:19,864 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:06:19,867 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD'
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1078, in _download_and_prepare
    split_generators = self._split_generators(dl_manager, **split_generators_kwargs)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/45b89185661cb2495bac49494aeebbdb88fab4b0d7114392fe29e25ab88cc57d/sroie.py", line 157, in _split_generators
    print(os.listdir(Path(downloaded_file)))
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD'
2024-03-21 00:08:09,333 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:08:09,340 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:08:09,340 torchfusion INFO: Global seed set to 42
2024-03-21 00:08:09,349 torchfusion INFO: Setting up datamodule...
2024-03-21 00:08:09,349 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:08:10,036 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:08:10,363 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:08:10,366 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: unsupported operand type(s) for /: 'str' and 'str'
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1078, in _download_and_prepare
    split_generators = self._split_generators(dl_manager, **split_generators_kwargs)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/1b7f3e7be26499935ad07780272561c22e7ffb1944f64ae3a136ec4da12322c7/sroie.py", line 161, in _split_generators
    print(downloaded_file[0] / "sroie")
TypeError: unsupported operand type(s) for /: 'str' and 'str'
2024-03-21 00:08:27,666 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:08:27,671 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:08:27,671 torchfusion INFO: Global seed set to 42
2024-03-21 00:08:27,679 torchfusion INFO: Setting up datamodule...
2024-03-21 00:08:27,679 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:08:28,333 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:08:28,651 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:08:28,654 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: expected str, bytes or os.PathLike object, not list
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1078, in _download_and_prepare
    split_generators = self._split_generators(dl_manager, **split_generators_kwargs)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/e42247f9b9a11770e9a9b218baac28175d027b73acd54ca91856d8b4df78baa7/sroie.py", line 163, in _split_generators
    print(os.listdir(Path(downloaded_file)))
  File "/usr/lib/python3.10/pathlib.py", line 960, in __new__
    self = cls._from_parts(args)
  File "/usr/lib/python3.10/pathlib.py", line 594, in _from_parts
    drv, root, parts = self._parse_args(args)
  File "/usr/lib/python3.10/pathlib.py", line 578, in _parse_args
    a = os.fspath(a)
TypeError: expected str, bytes or os.PathLike object, not list
2024-03-21 00:09:10,891 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:09:10,897 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:09:10,897 torchfusion INFO: Global seed set to 42
2024-03-21 00:09:10,905 torchfusion INFO: Setting up datamodule...
2024-03-21 00:09:10,905 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:09:11,610 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:09:11,954 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:09:11,959 torchfusion INFO: Generating examples from = /home/ataraxia/Datasets/documents/sroie/huggingface/downloads/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD/sroie/train
2024-03-21 00:09:11,960 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 545, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/7eac10765e7464aba105a20ea368d852646c3cbc2d76ed447b7956bda4212bd0/sroie.py", line 187, in _generate_examples
    for guid, fname in enumerate(sorted(os.listdir(img_dir))):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD/sroie/train/images'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 390, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 568, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:11:45,083 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:11:45,089 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:11:45,089 torchfusion INFO: Global seed set to 42
2024-03-21 00:11:45,097 torchfusion INFO: Setting up datamodule...
2024-03-21 00:11:45,097 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:11:45,810 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:11:46,155 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:11:46,158 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD/sroie'
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1078, in _download_and_prepare
    split_generators = self._split_generators(dl_manager, **split_generators_kwargs)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0461a0d2d276d0f3a4451ac2011781d6abbe88f0332da1314ac0492d7636e88b/sroie.py", line 159, in _split_generators
    print(os.listdir(Path(downloaded_file) / "sroie"))
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD/sroie'
2024-03-21 00:13:22,960 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:13:22,965 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:13:22,965 torchfusion INFO: Global seed set to 42
2024-03-21 00:13:22,973 torchfusion INFO: Setting up datamodule...
2024-03-21 00:13:22,973 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:13:23,675 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:13:24,019 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:13:24,022 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD/sroie'
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 311, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1078, in _download_and_prepare
    split_generators = self._split_generators(dl_manager, **split_generators_kwargs)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0461a0d2d276d0f3a4451ac2011781d6abbe88f0332da1314ac0492d7636e88b/sroie.py", line 159, in _split_generators
    print(os.listdir(Path(downloaded_file) / "sroie"))
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD/sroie'
2024-03-21 00:13:55,865 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:13:55,870 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:13:55,870 torchfusion INFO: Global seed set to 42
2024-03-21 00:13:55,878 torchfusion INFO: Setting up datamodule...
2024-03-21 00:13:55,878 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:13:56,538 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:13:56,881 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:13:58,388 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18/sroie'
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1078, in _download_and_prepare
    split_generators = self._split_generators(dl_manager, **split_generators_kwargs)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0461a0d2d276d0f3a4451ac2011781d6abbe88f0332da1314ac0492d7636e88b/sroie.py", line 159, in _split_generators
    print(os.listdir(Path(downloaded_file) / "sroie"))
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18/sroie'
2024-03-21 00:16:50,497 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:16:50,502 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:16:50,502 torchfusion INFO: Global seed set to 42
2024-03-21 00:16:50,510 torchfusion INFO: Setting up datamodule...
2024-03-21 00:16:50,510 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:16:51,168 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:16:51,501 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:16:51,504 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD/sroie'
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1078, in _download_and_prepare
    split_generators = self._split_generators(dl_manager, **split_generators_kwargs)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0461a0d2d276d0f3a4451ac2011781d6abbe88f0332da1314ac0492d7636e88b/sroie.py", line 159, in _split_generators
    print(os.listdir(Path(downloaded_file) / "sroie"))
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD/sroie'
2024-03-21 00:17:31,419 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:17:31,424 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:17:31,424 torchfusion INFO: Global seed set to 42
2024-03-21 00:17:31,432 torchfusion INFO: Setting up datamodule...
2024-03-21 00:17:31,432 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:17:32,125 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:17:32,463 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:17:52,431 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:17:52,436 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:17:52,436 torchfusion INFO: Global seed set to 42
2024-03-21 00:17:52,444 torchfusion INFO: Setting up datamodule...
2024-03-21 00:17:52,444 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:17:53,117 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:17:53,951 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:18:16,997 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:18:17,003 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:18:17,003 torchfusion INFO: Global seed set to 42
2024-03-21 00:18:17,011 torchfusion INFO: Setting up datamodule...
2024-03-21 00:18:17,011 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:18:18,441 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:18:19,262 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:18:19,265 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD'
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1078, in _download_and_prepare
    split_generators = self._split_generators(dl_manager, **split_generators_kwargs)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0461a0d2d276d0f3a4451ac2011781d6abbe88f0332da1314ac0492d7636e88b/sroie.py", line 156, in _split_generators
    downloaded_file = dl_manager.download_and_extract(get_drive_url(_URL))
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/download_manager.py", line 570, in download_and_extract
    return self.extract(self.download(url_or_urls))
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/download_manager.py", line 370, in extract
    print(os.listdir(extracted_paths))
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD'
2024-03-21 00:18:22,781 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:18:22,786 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:18:22,786 torchfusion INFO: Global seed set to 42
2024-03-21 00:18:22,795 torchfusion INFO: Setting up datamodule...
2024-03-21 00:18:22,795 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:18:23,849 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:18:24,175 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:18:24,178 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD'
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1078, in _download_and_prepare
    split_generators = self._split_generators(dl_manager, **split_generators_kwargs)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0461a0d2d276d0f3a4451ac2011781d6abbe88f0332da1314ac0492d7636e88b/sroie.py", line 156, in _split_generators
    downloaded_file = dl_manager.download_and_extract(get_drive_url(_URL))
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/download_manager.py", line 570, in download_and_extract
    return self.extract(self.download(url_or_urls))
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/download_manager.py", line 370, in extract
    print(os.listdir(extracted_paths))
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/uc?id=1ZyxAw1d-9UvhgNLGRvsJK4gBCMf0VpGD'
2024-03-21 00:20:16,201 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:20:16,207 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:20:16,207 torchfusion INFO: Global seed set to 42
2024-03-21 00:20:16,216 torchfusion INFO: Setting up datamodule...
2024-03-21 00:20:16,216 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:20:16,903 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:20:17,238 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:20:17,241 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18/sroie'
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1078, in _download_and_prepare
    split_generators = self._split_generators(dl_manager, **split_generators_kwargs)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/0461a0d2d276d0f3a4451ac2011781d6abbe88f0332da1314ac0492d7636e88b/sroie.py", line 159, in _split_generators
    print(os.listdir(Path(downloaded_file) / "sroie"))
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18/sroie'
2024-03-21 00:21:32,299 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:21:32,305 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:21:32,305 torchfusion INFO: Global seed set to 42
2024-03-21 00:21:32,313 torchfusion INFO: Setting up datamodule...
2024-03-21 00:21:32,313 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:21:33,038 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:21:33,381 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:25:35,421 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:25:35,426 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:25:35,426 torchfusion INFO: Global seed set to 42
2024-03-21 00:25:35,434 torchfusion INFO: Setting up datamodule...
2024-03-21 00:25:35,434 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:25:36,210 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:25:36,556 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:25:36,561 torchfusion INFO: Generating examples from = /home/ataraxia/Datasets/documents/sroie/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18/sroie/train
2024-03-21 00:25:36,563 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 617, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/c490406677072d6e04b15f50dc7ae371e7ec20bca758264d4617f084aeeac1bf/sroie.py", line 186, in _generate_examples
    for guid, fname in enumerate(sorted(os.listdir(img_dir))):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18/sroie/train/images'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 440, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 640, in _prepare_split_single
    raise DatasetGenerationError(
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:26:15,702 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:26:15,708 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:26:15,708 torchfusion INFO: Global seed set to 42
2024-03-21 00:26:15,718 torchfusion INFO: Setting up datamodule...
2024-03-21 00:26:15,718 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:26:16,398 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie2//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:26:16,720 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:26:18,222 torchfusion INFO: Generating examples from = /home/ataraxia/Datasets/documents/sroie2/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18/sroie/train
2024-03-21 00:26:18,223 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 617, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/c490406677072d6e04b15f50dc7ae371e7ec20bca758264d4617f084aeeac1bf/sroie.py", line 186, in _generate_examples
    for guid, fname in enumerate(sorted(os.listdir(img_dir))):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie2/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18/sroie/train/images'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 440, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 640, in _prepare_split_single
    raise DatasetGenerationError(
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:27:32,296 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:27:32,302 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:27:32,302 torchfusion INFO: Global seed set to 42
2024-03-21 00:27:32,309 torchfusion INFO: Setting up datamodule...
2024-03-21 00:27:32,310 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:27:33,172 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie2//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:27:33,491 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:27:33,496 torchfusion INFO: Generating examples from = /home/ataraxia/Datasets/documents/sroie2/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18/sroie/train
2024-03-21 00:27:33,497 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 617, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/12c17b1a31b718eab3275955feaa01ac87c29f358ca65b308c2abdb8110b8e88/sroie.py", line 213, in _generate_examples
    for guid, fname in enumerate(sorted(os.listdir(img_dir))):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie2/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18/sroie/train/images'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 440, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 640, in _prepare_split_single
    raise DatasetGenerationError(
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:28:04,427 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:28:04,432 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:28:04,432 torchfusion INFO: Global seed set to 42
2024-03-21 00:28:04,441 torchfusion INFO: Setting up datamodule...
2024-03-21 00:28:04,441 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:28:05,038 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: 
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 223, in _load_fusion_dataset
    builder = self._get_builder()
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 298, in _get_builder
    return DatasetFactory.create_builder(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 54, in create_builder
    return load_dataset_builder(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2265, in load_dataset_builder
    builder_instance: DatasetBuilder = builder_cls(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 382, in __init__
    info.update(self._info())
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 734, in _info
    raise NotImplementedError
NotImplementedError
2024-03-21 00:29:23,463 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:29:23,468 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:29:23,468 torchfusion INFO: Global seed set to 42
2024-03-21 00:29:23,476 torchfusion INFO: Setting up datamodule...
2024-03-21 00:29:23,476 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:29:24,676 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1726, in _prepare_split_single
    for key, record in generator:
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/e33fe300edf174ddf57fc82959dd8ee7fad615b8a75a0068f36c86ecf47310ff/sroie.py", line 219, in _generate_examples
    self._logger.info("Generating examples from = %s", filepath)
AttributeError: 'SROIE' object has no attribute '_logger'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1005, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1605, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1762, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:30:11,226 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:30:11,232 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:30:11,232 torchfusion INFO: Global seed set to 42
2024-03-21 00:30:11,240 torchfusion INFO: Setting up datamodule...
2024-03-21 00:30:11,240 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:30:12,231 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1726, in _prepare_split_single
    for key, record in generator:
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/724dd4585a8c2ce366a69a6a4deb8662520877c8f8d7146d87988626f6e3b5a6/sroie.py", line 220, in _generate_examples
    self._logger.info("Generating examples from = %s", filepath)
AttributeError: 'SROIE' object has no attribute '_logger'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1005, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1605, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1762, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:30:34,547 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:30:34,552 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:30:34,552 torchfusion INFO: Global seed set to 42
2024-03-21 00:30:34,562 torchfusion INFO: Setting up datamodule...
2024-03-21 00:30:34,562 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:30:35,604 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: [Errno 2] No such file or directory: 'dest'
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1005, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1078, in _download_and_prepare
    split_generators = self._split_generators(dl_manager, **split_generators_kwargs)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/5f7b689f37005a1908ce40a822254d6d31cf456750e9988d05405b9911684c29/sroie.py", line 194, in _split_generators
    print(os.listdir("dest"))
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
FileNotFoundError: [Errno 2] No such file or directory: 'dest'
2024-03-21 00:30:50,333 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:30:50,339 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:30:50,339 torchfusion INFO: Global seed set to 42
2024-03-21 00:30:50,347 torchfusion INFO: Setting up datamodule...
2024-03-21 00:30:50,347 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:30:51,384 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie2/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18'
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1005, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1078, in _download_and_prepare
    split_generators = self._split_generators(dl_manager, **split_generators_kwargs)
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/feb80b32ea126cfb374ddfdde2920ccee2e6a8cdaa9961319acea8846532f74f/sroie.py", line 194, in _split_generators
    print(os.listdir(Path(downloaded_file[0])))
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie2/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18'
2024-03-21 00:31:21,607 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:31:21,613 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:31:21,613 torchfusion INFO: Global seed set to 42
2024-03-21 00:31:21,621 torchfusion INFO: Setting up datamodule...
2024-03-21 00:31:21,621 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:31:22,613 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1726, in _prepare_split_single
    for key, record in generator:
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/243117f33a24000517d6a060ccd813012567bf72e3cad268e55424be24bab5a5/sroie.py", line 223, in _generate_examples
    for guid, fname in enumerate(sorted(os.listdir(img_dir))):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie2/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18/sroie/train/images'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1005, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1605, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1762, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:32:11,770 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:32:11,776 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:32:11,776 torchfusion INFO: Global seed set to 42
2024-03-21 00:32:11,784 torchfusion INFO: Setting up datamodule...
2024-03-21 00:32:11,785 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:32:14,757 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1726, in _prepare_split_single
    for key, record in generator:
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/243117f33a24000517d6a060ccd813012567bf72e3cad268e55424be24bab5a5/sroie.py", line 223, in _generate_examples
    for guid, fname in enumerate(sorted(os.listdir(img_dir))):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie32/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18/sroie/train/images'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1005, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1605, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1762, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:32:38,798 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:32:38,804 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:32:38,804 torchfusion INFO: Global seed set to 42
2024-03-21 00:32:38,812 torchfusion INFO: Setting up datamodule...
2024-03-21 00:32:38,812 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:32:39,810 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1726, in _prepare_split_single
    for key, record in generator:
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/243117f33a24000517d6a060ccd813012567bf72e3cad268e55424be24bab5a5/sroie.py", line 223, in _generate_examples
    for guid, fname in enumerate(sorted(os.listdir(img_dir))):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie32/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18/sroie/train/images'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1005, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1605, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1762, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:32:52,668 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:33:01,024 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:33:01,029 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:33:01,029 torchfusion INFO: Global seed set to 42
2024-03-21 00:33:01,037 torchfusion INFO: Setting up datamodule...
2024-03-21 00:33:01,037 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:33:03,482 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1726, in _prepare_split_single
    for key, record in generator:
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/243117f33a24000517d6a060ccd813012567bf72e3cad268e55424be24bab5a5/sroie.py", line 223, in _generate_examples
    for guid, fname in enumerate(sorted(os.listdir(img_dir))):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Projects/docllm/docllm/cache/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18/sroie/train/images'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1005, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1605, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1762, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:33:43,718 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:33:43,724 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:33:43,724 torchfusion INFO: Global seed set to 42
2024-03-21 00:33:43,732 torchfusion INFO: Setting up datamodule...
2024-03-21 00:33:43,732 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:33:45,639 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1726, in _prepare_split_single
    for key, record in generator:
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/243117f33a24000517d6a060ccd813012567bf72e3cad268e55424be24bab5a5/sroie.py", line 223, in _generate_examples
    for guid, fname in enumerate(sorted(os.listdir(img_dir))):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18/sroie/train/images'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1005, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1605, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1762, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:34:04,618 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:34:04,624 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:34:04,624 torchfusion INFO: Global seed set to 42
2024-03-21 00:34:04,632 torchfusion INFO: Setting up datamodule...
2024-03-21 00:34:04,632 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:34:05,708 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1726, in _prepare_split_single
    for key, record in generator:
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/243117f33a24000517d6a060ccd813012567bf72e3cad268e55424be24bab5a5/sroie.py", line 223, in _generate_examples
    for guid, fname in enumerate(sorted(os.listdir(img_dir))):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18/sroie/train/images'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1005, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1605, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1762, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:34:38,012 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:34:38,018 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:34:38,018 torchfusion INFO: Global seed set to 42
2024-03-21 00:34:38,027 torchfusion INFO: Setting up datamodule...
2024-03-21 00:34:38,027 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:34:39,060 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1726, in _prepare_split_single
    for key, record in generator:
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/243117f33a24000517d6a060ccd813012567bf72e3cad268e55424be24bab5a5/sroie.py", line 223, in _generate_examples
    for guid, fname in enumerate(sorted(os.listdir(img_dir))):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18/sroie/train/images'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1005, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1605, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1762, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:35:04,848 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:35:04,853 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:35:04,854 torchfusion INFO: Global seed set to 42
2024-03-21 00:35:04,862 torchfusion INFO: Setting up datamodule...
2024-03-21 00:35:04,862 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:35:07,538 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1726, in _prepare_split_single
    for key, record in generator:
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/243117f33a24000517d6a060ccd813012567bf72e3cad268e55424be24bab5a5/sroie.py", line 223, in _generate_examples
    for guid, fname in enumerate(sorted(os.listdir(img_dir))):
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/streaming.py", line 75, in wrapper
    return function(*args, download_config=download_config, **kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/download/streaming_download_manager.py", line 544, in xlistdir
    return os.listdir(path)
NotADirectoryError: [Errno 20] Not a directory: '/home/ataraxia/Datasets/documents/sroie/huggingface/downloads/d30727f5cdc1bff7eedfd1f924755d11c6a524c763bbe9da3a941066a3c9ab18/sroie/train/images'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1005, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1605, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1762, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:41:13,698 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:41:13,718 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:41:13,718 torchfusion INFO: Global seed set to 42
2024-03-21 00:41:13,967 torchfusion INFO: Setting up datamodule...
2024-03-21 00:41:13,968 torchfusion INFO: Loading data for stage == train|test|val
[2024-03-21 00:41:14,112][root][INFO] - Received ctrl-c interrupt. Stopping training...
2024-03-21 00:41:18,016 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:41:18,021 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:41:18,021 torchfusion INFO: Global seed set to 42
2024-03-21 00:41:18,029 torchfusion INFO: Setting up datamodule...
2024-03-21 00:41:18,029 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:41:19,473 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:41:19,826 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:41:19,870 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 617, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/901e85630141897c39329c2b6c5f2bc429fb5883cd0ccf311499e1ebe8e66a12/sroie.py", line 185, in _generate_examples_impl
    image = Image.open(image_path)
AttributeError: type object 'Image' has no attribute 'open'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 440, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 640, in _prepare_split_single
    raise DatasetGenerationError(
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:41:40,499 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:41:40,504 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:41:40,504 torchfusion INFO: Global seed set to 42
2024-03-21 00:41:40,512 torchfusion INFO: Setting up datamodule...
2024-03-21 00:41:40,512 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:41:41,305 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:41:41,647 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:41:41,670 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 617, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/ce55ab6f46770afb4ca8ab3c9cfc6dd0566f2bf8b84c17ba507ed0bf732b03cc/sroie.py", line 188, in _generate_examples_impl
    data.append(
AttributeError: 'dict' object has no attribute 'append'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 440, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 640, in _prepare_split_single
    raise DatasetGenerationError(
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:42:08,721 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:42:08,726 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:42:08,726 torchfusion INFO: Global seed set to 42
2024-03-21 00:42:08,734 torchfusion INFO: Setting up datamodule...
2024-03-21 00:42:08,734 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:42:09,421 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:42:09,752 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:42:09,759 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 617, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/298c7cc89747899c2203f1ad8e4d216290244334f8e35d1217d0621c795480fa/sroie.py", line 190, in _generate_examples_impl
    DataKeys.WORDS: data["words"],
TypeError: list indices must be integers or slices, not str

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 440, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 640, in _prepare_split_single
    raise DatasetGenerationError(
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:42:27,130 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:42:27,136 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:42:27,136 torchfusion INFO: Global seed set to 42
2024-03-21 00:42:27,144 torchfusion INFO: Setting up datamodule...
2024-03-21 00:42:27,144 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:42:27,819 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:42:28,631 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:42:28,638 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 617, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/f9d1a3e9bd83e09ecd59436c8155a485c26cae8fd28ded21ad45803b08860272/sroie.py", line 190, in _generate_examples_impl
    DataKeys.WORDS: data["words"],
TypeError: list indices must be integers or slices, not str

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 440, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 640, in _prepare_split_single
    raise DatasetGenerationError(
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:42:41,929 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:42:41,935 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:42:41,935 torchfusion INFO: Global seed set to 42
2024-03-21 00:42:41,943 torchfusion INFO: Setting up datamodule...
2024-03-21 00:42:41,943 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:42:42,639 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:42:42,974 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
[2024-03-21 00:43:41,128][root][INFO] - Received ctrl-c interrupt. Stopping training...
2024-03-21 00:43:45,177 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:43:45,183 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:43:45,183 torchfusion INFO: Global seed set to 42
2024-03-21 00:43:45,193 torchfusion INFO: Setting up datamodule...
2024-03-21 00:43:45,193 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:43:45,888 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:43:46,214 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:43:46,522 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 617, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/20f377d7acc0bc01411af6860b6f3dc6ac03d8cefde25c92f4c99a5bc83c9346/sroie.py", line 197, in _generate_examples_impl
    data = data.apply(convert_to_list, axis=1)
AttributeError: 'list' object has no attribute 'apply'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 440, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 640, in _prepare_split_single
    raise DatasetGenerationError(
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:44:16,463 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:44:16,468 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:44:16,468 torchfusion INFO: Global seed set to 42
2024-03-21 00:44:16,476 torchfusion INFO: Setting up datamodule...
2024-03-21 00:44:16,477 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:44:17,169 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:44:17,494 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:44:18,015 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 617, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 611, in record_preprocessor
    self.info.features.encode_example(record)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1889, in encode_example
    return encode_nested_example(self, example)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1244, in encode_nested_example
    {k: encode_nested_example(schema[k], obj.get(k), level=level + 1) for k in schema}
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1244, in <dictcomp>
    {k: encode_nested_example(schema[k], obj.get(k), level=level + 1) for k in schema}
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1300, in encode_nested_example
    return schema.encode_example(obj) if obj is not None else None
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1093, in encode_example
    if not -1 <= example_data < self.num_classes:
TypeError: '<=' not supported between instances of 'int' and 'list'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 440, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 640, in _prepare_split_single
    raise DatasetGenerationError(
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:45:10,378 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:45:10,383 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:45:10,384 torchfusion INFO: Global seed set to 42
2024-03-21 00:45:10,391 torchfusion INFO: Setting up datamodule...
2024-03-21 00:45:10,391 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:45:11,124 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:45:11,465 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:45:11,959 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 617, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 611, in record_preprocessor
    self.info.features.encode_example(record)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1889, in encode_example
    return encode_nested_example(self, example)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1244, in encode_nested_example
    {k: encode_nested_example(schema[k], obj.get(k), level=level + 1) for k in schema}
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1244, in <dictcomp>
    {k: encode_nested_example(schema[k], obj.get(k), level=level + 1) for k in schema}
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1300, in encode_nested_example
    return schema.encode_example(obj) if obj is not None else None
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1093, in encode_example
    if not -1 <= example_data < self.num_classes:
TypeError: '<=' not supported between instances of 'int' and 'list'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 440, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 640, in _prepare_split_single
    raise DatasetGenerationError(
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:45:35,736 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:45:35,741 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:45:35,741 torchfusion INFO: Global seed set to 42
2024-03-21 00:45:35,749 torchfusion INFO: Setting up datamodule...
2024-03-21 00:45:35,749 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:45:36,437 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:45:36,761 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:45:37,216 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 617, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 611, in record_preprocessor
    self.info.features.encode_example(record)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1889, in encode_example
    return encode_nested_example(self, example)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1244, in encode_nested_example
    {k: encode_nested_example(schema[k], obj.get(k), level=level + 1) for k in schema}
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1244, in <dictcomp>
    {k: encode_nested_example(schema[k], obj.get(k), level=level + 1) for k in schema}
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1300, in encode_nested_example
    return schema.encode_example(obj) if obj is not None else None
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1093, in encode_example
    if not -1 <= example_data < self.num_classes:
TypeError: '<=' not supported between instances of 'int' and 'list'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 440, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 640, in _prepare_split_single
    raise DatasetGenerationError(
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:47:09,440 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:47:09,446 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:47:09,446 torchfusion INFO: Global seed set to 42
2024-03-21 00:47:09,453 torchfusion INFO: Setting up datamodule...
2024-03-21 00:47:09,454 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:47:10,150 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:47:10,487 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:47:10,948 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 617, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 611, in record_preprocessor
    self.info.features.encode_example(record)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1889, in encode_example
    return encode_nested_example(self, example)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1244, in encode_nested_example
    {k: encode_nested_example(schema[k], obj.get(k), level=level + 1) for k in schema}
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1244, in <dictcomp>
    {k: encode_nested_example(schema[k], obj.get(k), level=level + 1) for k in schema}
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1300, in encode_nested_example
    return schema.encode_example(obj) if obj is not None else None
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1093, in encode_example
    if not -1 <= example_data < self.num_classes:
TypeError: '<=' not supported between instances of 'int' and 'list'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 440, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 640, in _prepare_split_single
    raise DatasetGenerationError(
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:47:31,297 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:47:31,303 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:47:31,303 torchfusion INFO: Global seed set to 42
2024-03-21 00:47:31,311 torchfusion INFO: Setting up datamodule...
2024-03-21 00:47:31,311 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:47:32,103 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:47:32,435 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:47:32,994 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 617, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 611, in record_preprocessor
    self.info.features.encode_example(record)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1889, in encode_example
    return encode_nested_example(self, example)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1244, in encode_nested_example
    {k: encode_nested_example(schema[k], obj.get(k), level=level + 1) for k in schema}
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1244, in <dictcomp>
    {k: encode_nested_example(schema[k], obj.get(k), level=level + 1) for k in schema}
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1295, in encode_nested_example
    return [encode_nested_example(schema.feature, o, level=level + 1) for o in obj]
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1295, in <listcomp>
    return [encode_nested_example(schema.feature, o, level=level + 1) for o in obj]
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1300, in encode_nested_example
    return schema.encode_example(obj) if obj is not None else None
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1094, in encode_example
    raise ValueError(f"Class label {example_data:d} greater than configured num_classes {self.num_classes}")
ValueError: Class label -100 greater than configured num_classes 9

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 440, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 640, in _prepare_split_single
    raise DatasetGenerationError(
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:47:43,602 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:47:43,608 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:47:43,608 torchfusion INFO: Global seed set to 42
2024-03-21 00:47:43,616 torchfusion INFO: Setting up datamodule...
2024-03-21 00:47:43,616 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:47:44,339 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:47:44,686 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:47:45,226 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 617, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 611, in record_preprocessor
    self.info.features.encode_example(record)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1889, in encode_example
    return encode_nested_example(self, example)
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1244, in encode_nested_example
    {k: encode_nested_example(schema[k], obj.get(k), level=level + 1) for k in schema}
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1244, in <dictcomp>
    {k: encode_nested_example(schema[k], obj.get(k), level=level + 1) for k in schema}
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1295, in encode_nested_example
    return [encode_nested_example(schema.feature, o, level=level + 1) for o in obj]
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1295, in <listcomp>
    return [encode_nested_example(schema.feature, o, level=level + 1) for o in obj]
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1300, in encode_nested_example
    return schema.encode_example(obj) if obj is not None else None
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/features/features.py", line 1094, in encode_example
    raise ValueError(f"Class label {example_data:d} greater than configured num_classes {self.num_classes}")
ValueError: Class label -100 greater than configured num_classes 9

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 440, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 640, in _prepare_split_single
    raise DatasetGenerationError(
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:49:25,491 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:49:25,496 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:49:25,496 torchfusion INFO: Global seed set to 42
2024-03-21 00:49:25,504 torchfusion INFO: Setting up datamodule...
2024-03-21 00:49:25,504 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:49:26,189 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:49:26,526 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:49:26,534 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 617, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/c1dc413c6e7251045ba665a1704e7ad3c58216a58b7eb69d861317cc252f03d7/sroie.py", line 194, in _generate_examples_impl
    DataKeys.LABEL: [
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/c1dc413c6e7251045ba665a1704e7ad3c58216a58b7eb69d861317cc252f03d7/sroie.py", line 195, in <listcomp>
    self.config.ner_labels.index(sample["labels"])
ValueError: ['O', 'O', 'O', 'B-COMPANY', 'I-COMPANY', 'I-COMPANY', 'I-COMPANY', 'I-COMPANY', 'I-COMPANY', 'I-COMPANY', 'B-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'O', 'O', 'O', 'O', 'O', 'O', 'B-DATE', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'B-TOTAL', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O'] is not in list

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 440, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 640, in _prepare_split_single
    raise DatasetGenerationError(
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:49:32,978 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:49:32,983 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:49:32,983 torchfusion INFO: Global seed set to 42
2024-03-21 00:49:32,991 torchfusion INFO: Setting up datamodule...
2024-03-21 00:49:32,991 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:49:33,684 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:49:34,508 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:49:34,516 torchfusion ERROR: Exception raised while loading the dataset [SROIE]: An error occurred while generating the dataset
Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 617, in _prepare_split_single
    for key, record in pool.imap(record_preprocessor, generator):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 873, in next
    raise value
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 144, in _helper_reraises_exception
    raise ex
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 391, in _guarded_task_generation
    for i, x in enumerate(iterable):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/fusion_dataset.py", line 66, in _generate_examples
    for key, sample in self._generate_examples_impl(*args, **kwargs):
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/6dea9d0433513d697eb0e0ba07529c28f6c4689d0ccdfadab8f87c6338dce9fa/sroie.py", line 194, in _generate_examples_impl
    DataKeys.LABEL: [
  File "/home/ataraxia/.cache/huggingface/modules/datasets_modules/datasets/sroie/6dea9d0433513d697eb0e0ba07529c28f6c4689d0ccdfadab8f87c6338dce9fa/sroie.py", line 195, in <listcomp>
    self.config.ner_labels.index(sample["labels"])
ValueError: ['O', 'O', 'O', 'B-COMPANY', 'I-COMPANY', 'I-COMPANY', 'I-COMPANY', 'I-COMPANY', 'I-COMPANY', 'I-COMPANY', 'B-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'I-ADDRESS', 'O', 'O', 'O', 'O', 'O', 'O', 'B-DATE', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'B-TOTAL', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O'] is not in list

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 343, in _load_dataset
    return self._load_fusion_dataset(split=split)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/data_modules/fusion_data_module.py", line 248, in _load_fusion_dataset
    msgpack_dataset = DatasetFactory.create(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/factory/dataset.py", line 26, in create
    return load_dataset(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/load.py", line 2582, in load_dataset
    builder_instance.download_and_prepare(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 351, in download_and_prepare
    self._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1767, in _download_and_prepare
    super()._download_and_prepare(
  File "/home/ataraxia/.virtualenvs/torchfusion/lib/python3.10/site-packages/datasets/builder.py", line 1100, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 440, in _prepare_split
    for job_id, done, content in self._prepare_split_single(
  File "/home/ataraxia/Projects/docllm/docllm/src/torchfusion/core/data/datasets/msgpack/builder.py", line 640, in _prepare_split_single
    raise DatasetGenerationError(
datasets.exceptions.DatasetGenerationError: An error occurred while generating the dataset
2024-03-21 00:49:58,049 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:49:58,054 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:49:58,055 torchfusion INFO: Global seed set to 42
2024-03-21 00:49:58,062 torchfusion INFO: Setting up datamodule...
2024-03-21 00:49:58,063 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:49:58,922 torchfusion.core.data.datasets.msgpack.builder INFO: Generating dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:49:59,258 torchfusion.core.data.datasets.msgpack.builder INFO: Dataset not on Hf google storage. Downloading and preparing it from source
2024-03-21 00:50:02,129 torchfusion WARNING: Using train set as validation set as no validation dataset exists. If this behavior is not required set, do_val=False in config.
2024-03-21 00:50:02,129 torchfusion INFO: Training set size = 626
2024-03-21 00:50:02,129 torchfusion INFO: Validation set size = 626
2024-03-21 00:50:02,368 torchfusion.core.data.datasets.msgpack.builder WARNING: Found cached dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:50:02,374 torchfusion INFO: Test set size = 347
2024-03-21 00:50:08,999 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:50:09,005 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:50:09,005 torchfusion INFO: Global seed set to 42
2024-03-21 00:50:09,012 torchfusion INFO: Setting up datamodule...
2024-03-21 00:50:09,013 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:50:09,712 torchfusion.core.data.datasets.msgpack.builder WARNING: Found cached dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:50:09,719 torchfusion WARNING: Using train set as validation set as no validation dataset exists. If this behavior is not required set, do_val=False in config.
2024-03-21 00:50:09,719 torchfusion INFO: Training set size = 626
2024-03-21 00:50:09,719 torchfusion INFO: Validation set size = 626
2024-03-21 00:50:09,757 torchfusion.core.data.datasets.msgpack.builder WARNING: Found cached dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:50:09,763 torchfusion INFO: Test set size = 347
2024-03-21 00:50:57,369 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:50:57,374 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:50:57,374 torchfusion INFO: Global seed set to 42
2024-03-21 00:50:57,383 torchfusion INFO: Setting up datamodule...
2024-03-21 00:50:57,384 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:50:58,055 torchfusion.core.data.datasets.msgpack.builder WARNING: Found cached dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:50:58,089 torchfusion INFO: Training set size = 501
2024-03-21 00:50:58,089 torchfusion INFO: Validation set size = 125
2024-03-21 00:50:58,128 torchfusion.core.data.datasets.msgpack.builder WARNING: Found cached dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:50:58,135 torchfusion INFO: Test set size = 347
2024-03-21 00:51:33,310 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:51:33,316 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:51:33,316 torchfusion INFO: Global seed set to 42
2024-03-21 00:51:33,324 torchfusion INFO: Setting up datamodule...
2024-03-21 00:51:33,325 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:51:34,200 torchfusion.core.data.datasets.msgpack.builder WARNING: Found cached dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:51:34,294 torchfusion INFO: Training set size = 501
2024-03-21 00:51:34,295 torchfusion INFO: Validation set size = 125
2024-03-21 00:51:34,333 torchfusion.core.data.datasets.msgpack.builder WARNING: Found cached dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:51:34,339 torchfusion INFO: Test set size = 347
2024-03-21 00:51:50,684 torchfusion INFO: Starting torchfusion training script
2024-03-21 00:51:50,690 torchfusion INFO: Running task: prepare_dataset
2024-03-21 00:51:50,690 torchfusion INFO: Global seed set to 42
2024-03-21 00:51:50,698 torchfusion INFO: Setting up datamodule...
2024-03-21 00:51:50,698 torchfusion INFO: Loading data for stage == train|test|val
2024-03-21 00:51:51,394 torchfusion.core.data.datasets.msgpack.builder WARNING: Found cached dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:51:51,402 torchfusion INFO: Training set size = 501
2024-03-21 00:51:51,402 torchfusion INFO: Validation set size = 125
2024-03-21 00:51:51,440 torchfusion.core.data.datasets.msgpack.builder WARNING: Found cached dataset sroie (/home/ataraxia/Datasets//documents/sroie//huggingface/sroie/default-default/0.0.0)
2024-03-21 00:51:51,447 torchfusion INFO: Test set size = 347
